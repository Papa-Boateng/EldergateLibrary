{% extends 'layout.html' %}

{% block title %}Dashboard - Eldergate Library{% endblock %}

{% block content %}
{% include 'includes/header.html' %}

<div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden">
    <div class="layout-container flex h-full grow flex-col">
      <!-- <main class="px-10 py-8"> -->
        <section class="mb-12">
          <h2 class="text-slate-50 text-2xl font-bold leading-tight tracking-[-0.015em] mb-4">Currently Reading</h2>
          <div class="flex items-stretch justify-between gap-8 rounded-lg bg-card-dark p-6 border border-border-dark">
            <div class="flex flex-[2_2_0px] flex-col justify-between gap-4">
              <div>
                <p class="text-slate-50 text-2xl font-bold leading-tight">{{ current_reading_book.title }}</p>
                <p class="text-slate-400 text-base font-normal leading-normal mt-1">{{ current_reading_book.author }}</p>
                <div class="mt-6">
                  <div class="flex gap-6 justify-between mb-2">
                    <p class="text-slate-50 text-base font-medium leading-normal">Page {{ user.reading_progress }} of {{ current_reading_book.total_pages }}</p>
                    <p class="text-slate-50 text-sm font-normal leading-normal">{{ reading_progress_pt }}%</p>
                  </div>
                  <div class="rounded bg-[#21262d]">
                    <div class="h-2 rounded bg-primary" style="width: {{ reading_progress_pt }}%;"></div>
                  </div>
                </div>
              </div>
              <a href="{% url 'pdf-viewer' current_reading_book.id %}"
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-primary text-slate-50 text-sm font-bold leading-normal tracking-[0.015em] w-fit hover:bg-primary/90 transition-colors">
                <span class="truncate">Continue Reading</span>
              </a>
            </div>
            <div class="w-full bg-center bg-no-repeat aspect-[4/3] bg-cover rounded-lg flex-1 max-w-xs"
              data-alt="Book cover for The Midnight Library"
              style='background-image: url("{{ current_reading_book.cover_image.url }}");'>
            </div>
          </div>
        </section>
        <section class="px-8 py-8">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-slate-50 text-2xl font-bold leading-tight tracking-[-0.015em]">My Purchased Books</h2>
            <div class="flex gap-4">
              <select
                class="form-select rounded-lg bg-card-dark border-border-dark text-slate-50 text-sm focus:ring-primary focus:border-primary">
                <option>Filter by Genre</option>
                <option>Fiction</option>
                <option>Non-Fiction</option>
                <option>Fantasy</option>
              </select>
              <select
                class="form-select rounded-lg bg-card-dark border-border-dark text-slate-50 text-sm focus:ring-primary focus:border-primary">
                <option>Sort by</option>
                <option>Title</option>
                <option>Author</option>
                <option>Date Added</option>
              </select>
            </div>
          </div>
          <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            {% for book in my_purchased_books %}
            <div
              class="flex flex-col gap-4 rounded-lg bg-card-dark p-4 border border-border-dark group hover:scale-105 transition-transform duration-300 hover:border-primary">
              <div class="w-full bg-center bg-no-repeat aspect-[2/3] bg-cover rounded-lg"
                data-alt="Book cover for {{ book.title }}"
                style='background-image: url("{{ book.cover_image.url }}");'>
              </div>
              <div class="flex flex-col gap-1 flex-grow">
                <p class="text-slate-50 text-base font-bold leading-tight">{{ book.title }}</p>
                <p class="text-slate-400 text-sm font-normal leading-normal">{{ book.author }}</p>
              </div>
              <a href="{% url 'pdf-viewer' book.id %}"
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-9 px-4 bg-primary/30 text-slate-50 text-sm font-medium leading-normal w-full group-hover:bg-primary group-hover:text-white transition-colors">
                <span class="truncate">Read Now</span>
              </a>
            </div>
            {% endfor %}
          </div>
        </section>
        <section class="mt-12 px-8 py-8">
          <h2 class="text-slate-50 text-2xl font-bold leading-tight tracking-[-0.015em] mb-4">My Free Books</h2>
          <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            {% for book in my_free_books %}
            <div
              class="flex flex-col gap-4 rounded-lg bg-card-dark p-4 border border-border-dark group hover:scale-105 transition-transform duration-300 hover:border-primary">
              <div class="w-full bg-center bg-no-repeat aspect-[2/3] bg-cover rounded-lg"
                data-alt="Book cover for {{ book.title }}"
                style='background-image: url("{{ book.cover_image.url }}");'>
              </div>
              <div class="flex flex-col gap-1 flex-grow">
                <p class="text-slate-50 text-base font-bold leading-tight">{{ book.title }}</p>
                <p class="text-slate-400 text-sm font-normal leading-normal">{{ book.author }}</p>
              </div>
              <a href="{% url 'pdf-viewer' book.id %}"
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-9 px-4 bg-primary/30 text-slate-50 text-sm font-medium leading-normal w-full group-hover:bg-primary group-hover:text-white transition-colors">
                <span class="truncate">Read Now</span>
              </a>
            </div>
            {% endfor %}
          </div>
        </section>
        <div class="text-center py-20 hidden">
          <h3 class="text-slate-50 text-xl font-semibold mb-2">Your library is empty.</h3>
          <p class="text-slate-400 mb-6">Explore the store to find your next great read!</p>
          <button
            class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-6 bg-primary text-slate-50 text-sm font-bold leading-normal tracking-[0.015em] mx-auto hover:bg-primary/90 transition-colors">
            <span class="truncate">Go to Store</span>
          </button>
        </div>
      <!-- </main> -->
    </div>
  </div>
{% endblock %}
